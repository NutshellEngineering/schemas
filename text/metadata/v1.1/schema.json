{
  "$id": "https://nutshellengineering.github.io/schemas/text/metadata/v1.1/schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "TextsMetadata",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    "texts": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "filename": {
            "type": "string",
            "minLength": 1,
            "description": "The filename"
          },
          "slug": {
            "type": "string",
            "minLength": 1,
            "description": "The URL slug"
          },
          "created": {
            "type": "string",
            "format": "date-time",
            "description": "An optional timestamp in RFC 3339 format, e.g. 2025-10-09T15:20:30Z"
          },
          "updated": {
            "type": "string",
            "format": "date-time",
            "description": "An optional timestamp in RFC 3339 format, e.g. 2025-10-09T15:20:30Z"
          },
          "availability": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^(key-ideas|sections|major-characters|minor-characters)$": {
                "type": "integer",
                "minimum": 0
              }
            },
            "description": "Optional availability counts for different content types"
          },
          "title": {
            "type": "string",
            "minLength": 1,
            "description": "The title of the text"
          },
          "subtitle": {
            "type": "string",
            "description": "Optional subtitle of the text"
          },
          "authors": {
            "type": "array",
            "minItems": 1,
            "items": { "$ref": "#/definitions/Person" },
            "description": "One or more authors of the text"
          },
          "description": {
            "type": "string",
            "minLength": 1,
            "description": "A sentence describing the book"
          },
          "subject": {
            "$ref": "#/definitions/Category",
            "description": "Single subject from categories/subjects.json"
          },
          "themes": {
            "type": "array",
            "minItems": 1,
            "maxItems": 5,
            "items": {
              "$ref": "#/definitions/Category"
            },
            "description": "1-5 themes from categories/themes.json"
          },
          "audience": {
            "type": "string",
            "enum": ["General"],
            "description": "Target audience, always 'General'"
          },
          "locale": {
            "type": "string",
            "enum": ["en-gb"],
            "description": "Always en-gb"
          },
          "publication-date": {
            "type": "integer",
            "minimum": 1,
            "description": "Earliest year of publication"
          },
          "isbn": {
            "type": "string",
            "pattern": "^[0-9]{13}$",
            "description": "13-digit ISBN identifier"
          },
          "content-warnings": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/Category"
            },
            "description": "Content warnings from categories/content-warning.json (for books 1900+)"
          }
        },
        "required": [
          "filename",
          "slug",
          "title",
          "authors",
          "description",
          "subject",
          "locale",
          "isbn",
          "created"
        ],
        "additionalProperties": false
      },
      "minItems": 1
    }
  },
  "definitions": {
    "Person": {
      "type": "object",
      "additionalProperties": false,
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Person's full name"
        }
      }
    },
    "Category": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "name"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique identifier for this category"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Category name"
        }
      }
    }
  }
}
